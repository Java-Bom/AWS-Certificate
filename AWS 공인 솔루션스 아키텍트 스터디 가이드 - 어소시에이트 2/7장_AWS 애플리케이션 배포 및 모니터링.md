## AWS Lamda

- 애플리케이션의 각종 이벤트에 반응해 백엔드 코드를 실행하는 컴퓨팅 서비스
    - Amazon S3 버킷 이미지 업로드
    - DynamoDB 테이블 갱신
    - Kinesis Data Streams 데이터 입력
    - 인앱 액티비티
- 코드 실행에 필요한 용량 및 확장성 관리, 패치 업무, 인프라 관련 업무 등 재반 서버 관련 업무 처리
- 처리 결과로 생성된 성능 지표는 실시간으로 CloudWatch에 전송
- 초기 설치비 부담이 없는 저비용 서비스
    - 코드 실행 요청별 및 코드 실행 시간별로 부과되는 비용만 부담
- AWS SDK를 지원

### AWS Lambda는 서버리스?

- 서버리스란
    - 인프라 관리 필요성 없음
    - 확장성
    - 내재된 중복 구현성
    - 사용량에 대한 과금
- AWS 서버리스 서비스
    - Amazon S3
    - Amazon DynamoDB
    - Amazon API Gateway
    - AWS Lambda
    - Amazon SNS and SQS
    - Amazon CloudWatch Events
    - Amazon Kinesis
- 서버리스 용어는 개발자가 부담해야 할 프로비저닝, 유지보수, 안정화 관리, 장애대응 등 다양한 업무 대상이 되는 서버가 없다는 뜻

### AWS Lambda

- 거의 모든 타입의 애플리케이션과 백엔드 서비스를 위한 코드를 실행할 수 있음
- 고가용성하에 코드 실행 및 확장성을 유지할 수 있음
- 이벤트 환경을 설정한 뒤 이벤트가 발생하면 거의 즉각적으로 코드가 호출
- 일정 시점에 실행할 수 있는 Lambda 함수의 개수 제한은 없음
- 상태 정보를 저장하지 않는 stateless 속성
- Lambda를 활용하기 위한 기본적인 단계
    1. Lambda에 코드를 업로드
    2. 함수에 IAM 롤을 추가
    3. Lambda 함수를 호출하기 위한 트리거 추가
    4. (처리 결과를 보내기 위한) 목적지의 환경 설정
    5. 어느 주기로 실행될 지, 이벤트에 의해 실행될 지, 이벤트 소스의 내용을 어떻게 할 지 설정
    6. 컴퓨트 리소스, 이벤트 타임아웃, VPC 세부사항 등 환경 요소 설정

### AWS Lambda 호출별 리소스 용량 제한

- 코드 실행 시간이 요청당 300초가 최대
- 최대 동시 실행 코드 수는 1000건
    - 서포트 티켓으로 상향 조절 가능

### Lambda 사용 패턴

- 다양한 AWS 서비스에 의해 직접 실행될 수 있음
- 패턴의 종류
    - 실시간 파일 데이터 처리
    - 실시간 스트림 데이터 처리
    - ETL(Extract, Transform, Load) 작업
    - Cron 대체
    - AWS Events 처리

## Amazon API Gateway

- API의 정의, 퍼블리싱, 배포, 유지, 모니터링, 확장에 이르는 모든 업무를 안전하게 처리할 수 있도록 하는 완전 관리형 API 서비스
- 표준 HTTPS 요청을 통해 해당 API를 통합할 수 있음
- 모든 웹 애플리케이션과 연결할 수 있는 창구로서의 역할을 수행
- 주요 활용 방식
    - 백엔드 HTTP 엔드포인트, AWS Lambda 함수 또는 기타 AWS 서비스에 연결하기 위한 레스트풀 API의 생성, 배포, 관리
    - 프론트엔드 HTTP 엔드포인트를 통해 외부로 노출된 API 호출
- API 호출 및 전송된 데이터의 양에 따라 비용을 지불

### API Gateway 지원 API 유형

- REST API
- WebSocket API
- HTTP API

### Amazon API Gateway 장점

- 높은 성능 및 장애 대응성
- 캐싱 기능
- 보안성
    - AWS IAM, Amazon Cognito 등으로 접속 권한 관리 가능
    - 최신 서명 관리 프로토콜 Signature Version 4 적용
- 이용량 측정
    - API에 대한 요청을 자동으로 측정
    - 관련 데이터를 API 키 별로 추출 가능
        - API 키에 대한 접근 허용 조건 설정 가능
        - API 키 별로 성능 증가/감소 및 할당량 제한 가능
- 모니터링
- 라이프 사이클 관리
- 다른 AWS 서비스와의 통합
- Open API 명세서 지원
    - Swagger
- iOS, Android, JavaScript용 SDK 지원

## Amazon Kinesis

### 실시간 애플리케이션 시나리오

- 배치 분석에서 스트리밍 분석으로 진화
    - 기존에는 데이터가 누적된 상태에서 배치로 일괄 처리
    - 실시간으로 데이터가 유입될 때 해당 데이터를 처리
        - 자주 업데이트 가능해 분석 결과가 보다 정확 및 신뢰
- 실시간 애플리케이션 개발

### 배치 데이터 처리와 스트리밍 데이터 처리의 차이점

- 배치 분석
    - 데이터 수집, 데이터베이스 입력, 분석까지 적게는 수 시간, 많게는 수 주의 시간이 소요
- 실시간 분석
    - 유입 데이터의 속도와 다양성에 맞춰 유연하게 작동해야 함
    - 시간당 유입되는 수백만에서 수십억 건의 이벤트를 신속하게 처리할 수 있어야 함
- Amazon Kinesis 패밀리
    - Amazon Kinesis Data Streams
    - Amazon Kinesis Data Firehose
    - Amazon Kinesis Data Analytics
    - Amazon Kinesis Video Streams

## Amazon Kinesis Data Streams

- 특화된 분석 목적에 맞춰 스트리밍 데이터에 대한 실시간 분석 서비스를 제공
- KCL(Kinesis Client Library)
    - 스트리밍 데이터를 이용해 실시간 대시보드, 실시간 경고, 동적 가격 책정 및 광고 집행과 같은 기능을 수행하는 Kinesis 애플리케이션 구동을 돕는 라이브러리

### Amazon Kinesis Data Streams 장점

- 실시간성
- 안정성
- 편리성
    - KPL(Kinesis Producer Library)를 이용해 간편하게 스트림데이터 입력 가능
    - KCL을 이용해 실시간 데이터 처리 애플리케이션을 만들 수 있음
- 병렬처리
    - 동일한 스트림을 각각의 Kinesis 애플리케이션으로 다르게 처리 가능
- 탄력성
    - 입력 데이터의 크기에 따라 즉각적으로 스트림 데이터의 처리 성능을 동적으로 조절 가능
- 저비용
    - 리소스 사용비만 부담
- 신뢰성
    - 리전 내 세 개의 시설에 스트리밍 데이터를 동기적으로 복제해 7일동안 보관

## Amazon Kinesis Data Firehose

- 데이터 저장소와 분석 도구에 스트리밍 데이터를 로딩하기 위한 가장 간단한 방법을 제공
- 설정비, 기본이용료 등에 대한 걱정 없이 데이터 전송 비용만을 부담
- 스트리밍 데이터를 로딩하기 위한 스토리지, 네트워킹, 환경 설정 등 모든 인프라를 관리
    - Amazon S3, Redshift, Elasticsearch, Splunk에 데이터만 로딩하면 됨

### Amazon Kinesis Data Firehose 장점

- 사용 편리성
- AWS 데이터 저장 서비스와의 통합
    - S3, Redshift, Elasticsearch 등 AWS 저장 서비스와 통합해서 사용 가능
- 서버리스 데이터 변환
    - 데이터 저장소로 로딩하기 전 스트리밍 데이터를 적절한 형식으로 가공 및 변환 가능
- 근실시간
    - 근실시간 처리 성능 제공
    - 데이터 저장소로 전송된 데이터를 60여초 이내 로딩 가능
- 지속적 관리 필요 없음
- 사용량에 따른 과금

## Amazon Kinesis Data Analytics

- 실시간성의 스트리밍 데이터를 처리 및 분석하기 위한 가장 간단한 방법
- 표준 SQL 방식 사용

### Amazon Kinesis Data Analytics 장점

- 강력한 실시간 처리 성능
    - 스트리밍 데이터 처리 시 1초 미만의 처리 지연 성능 제공
    - 스트리밍 데이터 처리를 위한 내장 함수 제공
- 완전 관리형
- 자동화된 탄력성
- 사용 편의성
- 표준 SQL
- 사용량에 따른 과금

## Amazon Kinesis Video Streams

- 공인 솔루션스 아키텍트-어소시에이트 시험 범위에 포함되지 않음
- 완전 관리형 서비스로 미디어 파일의 포맷별 입력, 저장, 용도별 처리 등에 활용
- 수행 가능한 작업
    - 수백만 개의 디바이스로부터 비디오 스트리밍
    - 실시간 영상 송출 및 비디오 애플리케이션 개발
    - 라이브 비디오 재생 및 비디오 스트림 기록
    - 양방향 실시간 미디어 스트리밍 애플리케이션 개발

## Amazon CloudFront

- 글로벌 CDN 서비스로 저지연성과 고속전송 속성을 지닌 콘텐츠 배포 기능을 제공
- 콘텐츠 사용자와 가까운 지역(엣지 로케이션)에 네트워크 망을 구축하고 지역별 엣지 캐시를 통해 사용자 경험 수준을 높여줌
- 사용자의 요청은 가장 가까운 엣지 로케이션에서 처리
- 실제로 요청 및 전송한 데이터에 대한 비용만 부담
- 활용 시나리오
    - 정적 콘텐츠 캐싱
        - 가장 대표적인 활용 방식
    - 동적 콘텐츠
        - EC2 서버에서 실행 중인 애플리케이션 또는 웹사이트를 CloudFront와 통합 가능
    - DDoS 공격 대응
        - 레이어 3, 4, 7을 보호할 수 있는 Shield, WAF와 통합해 방어 가능
    - 강화된 보안성
        - SSL 방식의 보안 기능 제공
    - API 호출 가속화
        - API Gateway와 통합해 API 호출 가속화 가능
    - 소프트웨어 배포
        - 소프트웨어 배포에 이용시 다운로드 속도가 높아져서 사용자 경험 수준을 높일 수 있음
    - 비디오 스트리밍

### Amazon CloudFront 핵심 개념

- 엣지 로케이션
    - 글로벌 데이터센터 네트워크
- 지역별 엣지 캐시
    - 오리진 웹 서버와 엣지 로케이션 사이에 위치해 사용자에게 직접 콘텐츠를 전송
    - 엣지 로케이션보다 높은 수준의 캐싱 능력을 바탕으로 좀 더 오랜 시간 캐싱 데이터를 유지
    - 엣지 로케이션 대신 사용자 요청에 대응
- 배포
    - 원본 파일의 위치를 나타내는 CloudFront 경로
    - [CloudFront.net](http://CloudFront.net) 도메인 네임으로 표시
- 오리진
    - S3, HTTP 서버, ELB, ALB, AWS 외부 커스텀 오리진 서버를 통해 접근 가능
- 제어 동작
    - CloudFront의 세부적인 제어 동작
        - CDN과 관련된 정책의 적용
        - 요청 타입에 따른 반응 변경
        - 객체의 캐싱 기능 조절
    - 주요 제어 동작 종류
        - 경로 패턴 매칭
            - 웹사이트 또는 애플리케이션의 URL 경로 패턴에 따라 다양한 캐시 제어 동작 설정
        - 헤더
            - 헤더 값을 통해 요청 헤더를 오리진 캐시로 포워딩 가능
        - 쿼리 문자열 및 쿠키
            - 오리진으로 정보를 전달하기 위해 쿼리 문자열 사용
        - 서명 URL 및 서명 쿠키
            - CloudFront의 서명 URL 방식을 통해 해당 콘텐츠에 대한 비인가 접근을 막을 수 있음
        - 프로토콜 정책
        - 유지시간
            - CloudFront에서 오리진으로 요청을 전송하기 전 캐시에 특정 객체의 유지시간을 지정할 수 있음
            - 유지 시간과 관련된 기간을 증가
                - 엣지 캐시에 좀 더 오래 유지되므로 성능이 높아짐
                - 오리진 서버에서의 유지 시간은 줄어들게 됨
            - TTL은 최소, 최대, 기본 값으로 설정 가능 (초 단위 설정 가능)
                - 기본 설정은 모든 객체를 24시간 후 자동으로 캐시에서 삭제
        - gzip 압축
            - 배포 시점에 시행 가능

### 지역 제한 기능

- 접속 허용 국가 목록인 화이트리스트 기반으로 요청 콘텐츠 접근 허용 가능
- 접속 금지 국가 목록인 블랙리스트 기반으로 요청 콘텐츠 접근 거절 가능

### 오류 처리 기능

- 오리진 서버가 4xx, 5xx 상태 코드를 반환하면 커스텀 오류 페이지를 제공 가능

## Amazon Route 53

- Amazon의 관리형 DNS 서비스
- 고가용성, 고확장성 서비스로서, 100% SLA(Service-Level Agreement)를 보장하는 유일한 서비스
    - 리전과 독립적으로 작동
- 다수의 리전과 AWS VPC 간의 DNS 주소변환도 가능
- 지원 DNS 기록 타입
    - A
    - AAAA
    - CNAME
    - CAA
    - MX
    - NAPTR
    - NS
    - PTR
    - SOA
    - SPF
    - SRV
    - TXT
- 알리아스 기록(존 에이팩스)을 지원
    - 존 에이팩스는 루트 도메인을 의미
    - CloudFront를 통해 루트 도메인으로 콘텐츠를 전송 가능
- DNS 명세서에는 CNAME이 아닌 IP 주소(A 주소 기록)를 가리키는 존 에이팩스를 입력해야 함
- 헬스 체크 기능 제공
    - 리소스의 헬스 상태가 나빠졌다면 헬스 상태가 좋은 리소스만을 활용해서 요청에 대응
- 지원하는 라우팅 정책
    - 가중치 라운드 로빈
        - 여러 리소스에 트래픽 분산 가능
        - A/B 테스트에 활용
    - 지연 기반 라우팅
        - 엣지 로케이션에 연결해 최저 지연 시간으로 제공
    - 장애 대응 라우팅
        - 장애 대응을 통해 가용 리소스 쪽으로 트래픽을 라우팅하고 싶다면 사용
    - 지역 DNS 라우팅
        - 사용자의 지역에 따라 DNS 쿼리에 응답

## AWS 웹 어플리케이션 방화벽(WAF)

- AWS가 제공하는 웹 어플리케이션 방화벽 서비스
- 다양한 침해 시도로 부터 웹 애플리케이션을 보호
- 주요 용도
    - 침해 시도로부터 보호
        - SQL 인젝션 공격, XSS 공격 등 주요 침해 시도로부터 보호
    - 악성 요청 대응
        - 웹 크롤러에 의한 대량의 데이터 침탈 시도로부터 보호
    - DDoS 공격 방어
- CloudFront와 통합해 CDN 배포 용량과 확장성을 높일 수 있음
    - 소스 인근에서 발생하는 차단 공격을 방어하므로 로딩 시간을 줄일 수 있음
- WAF와 CloudFront 또는 ALB와 함께 사용하려면 보호하려는 리소스를 정확하게 정의
    - 애플리케이션 보호에 가장 적합한 규칙 또는 필터를 적용해야 함
- 보안 조건
    - AWS WAF를 통해 관찰하려는 웹 요청의 기본적 특성을 정의한 것
    - 특성에 따라 요청을 허용 또는 차단
    - 크로스 사이트 스크립팅 조건
    - IP 일치 조건
    - 지역 일치 조건
    - 전송 용량 제한 조건
    - SQL 인젝션 일치 조건
    - 문자열 일치 조건
    - 정규표현식 일치 조건
- AWS WAF에는 일반 규칙과 비율 규칙이 존재
    - 일반 규칙은 특정 요청을 목표로 하는 조건만 사용
    - 비율 규칙은 일반 규칙과 거의 동일하되, 5분 간격으로 비율 제한을 적용
        - 비율 제한이 2000 → 5분동안 특정 IP 주소에서 들어오는 요청의 횟수를 측정, 2000회가 넘을 경우 차단
- WAF는 보안 조건을 보안 규칙에 결합한 뒤 보안 규칙을 웹 ACL에 결합
    - 규칙에 대한 액션 정의 가능, 액션은 허용, 차단, 카운트

## Amazon Shield

- AWS에서 실행되는 애플리케이션에 대한 분산 DDoS 공격을 방어하기 위한 관리형 서비스
- AWS Shield는 Standard와 Advanced가 존재

### Amazon Shield 장점

- Standard는 모든 AWS 고객에게 자동 적용
    - 별도의 비용 없음
- Advanced는 필요에 따라 선택 가능
    - 별도의 비용 청구
- AWS Shield Standard
    - 네트워크 및 전송 레이어에 대한 DDoS 공격으로부터 AWS 고객을 보호
- AWS Shield Advanced
    - AWS Global DDoS 대응 팀에 접속해 공격 대응 및 무력화 지원 요청 가능
    - DDoS 공격에 대한 상세한 시각화 제공
    - Global Threat Environment 대시보드에 접속해 공격 속성을 면밀히 분석 가능
    - AWS WAF, AWS Firewall Manager를 무료로 이용 가능
    - 상향 조절된 서비스 레벨 적용

## Amazon SQS

- 기존 애플리케이션을 클라우드로 마이그레이션할 때 가장 큰 도전과제는 고분산성을 구현하는 것
- 메시징 기법은 클라우드에서 분산 아키텍처를 구현할 때 매우 유용
- 메시지 큐는 임시로 메시지를 저장하는 버퍼, 메시지의 수신 및 발신을 위한 연결 부분인 엔드포인트를 제공
- 큐에 메시지를 넣는 소프트웨어를 메시지 프로듀서
- 큐에서 메시지를 꺼내는 소프트웨어를 메시지 컨슈머
- Amazon SQS는 신속성, 신뢰성, 확장성을 지닌 완전 관리형 큐 서비스
- 주요 기능
    - 각 리전에서 다중 AZ를 중복 구현 가능
    - 다수 복제 메시지를 다중 AZ 환경에 저장 가능
        - 메시지는 최대 14일간 유지 가능
    - 메시지 프로듀서, 컨슈머 애플리케이션이 실패하더라도 메시지는 소실되지 않음
    - 별도의 프로비저닝 없이 확장 가능
- SQS 큐의 종류
    - 스탠다드 큐
        - 초당 거의 무제한의 트랜잭션을 지원
        - 최소 1회 메시지 전송 보장
        - 전송 순서대로 도착하는 것을 보장하는 전송 순서 보장 기능 제공
        - 가끔은 순서와 다른 메시지가 전송되기도 함
        - 전송 순서가 매우 중요한 경우 FIFO 큐 사용
    - FIFO 큐
        - FIFO 원칙 적용
        - 처리 성능은 초당 300회의 트랜잭션으로 제한
        - 메시지는 초당 최대 3000개까지 지원
- 메시지가 처리되면 0초 ~ 12시간에 이르는 가시성 타임아웃 기간동안 큐에 유지
- 가시성 타임아웃이 만료되면 컨슈머는 큐에서 메시지를 삭제해 재수신 및 재처리되지 않도록 함
- SQS 주요 용어 및 파라미터
    - 메시지 보유 기간
        - 수신자가 메시지를 삭제하기 전까지 SQS가 메시지를 보유하는 기간
        - 최소 1분
        - 최대 14일
    - 최대 메시지 크기
        - SQS가 수신할 수 있는 최대 메시지의 크기
        - 최소 1KB
        - 최대 256KB
    - 전송 지연 시간
        - 큐에 포함된 모든 메시지의 전송 지연 또는 연기 기간
        - 최소 0초
        - 최대 15분
        - 지연 큐를 사용하면 여기에 포함된 모든 메시지는 해당 지연 시간만큼 보이지 않게 됨
            - 스탠다드 큐는 이미 큐에 포함된 메시지에 적용되지 않음
            - FIFO 큐는 이미 포함된 메시지에 적용
    - 수신 메시지 대기 시간
        - 숏 폴링과 롱 폴링 옵션을 사용 가능
        - 숏 폴링
            - 메시지를 즉시 반환
            - 수신 메시지 대기 시간을 0초로 설정하면 사용 가능
        - 롱 폴링
            - 빈 메시지 응답, 메시지가 포함되지 않은 응답의 수를 줄여줌
            - 메시지가 준비되는 즉시 메시지를 전송해 SQS 이용 비용을 줄여줌
            - 수신 메시지 대기 시간을 1~20초로 설정하면 사용 가능
    - 콘텐츠 기반 복제
        - FIFO 큐에서만 사용 가능
- 다른 큐가 처리하지 못한 메시지의 타깃을 설정할 수 있는 데드레터 큐 기능 제공
    - Use Redrive Policy 파라미터를 이용해 최대 수신 설정을 초과한 메시지를 데드레터 큐에 넣을 수 있음
- SQS는 서버측 암호화, SSE를 이용해 암호화된 큐에 메시지를 전송 가능
    - KMS 키를 이용해 SQS 큐에 담긴 메시지를 보호할 수도 있음

## Amazon SNS

- 클라우드 기반의 노티피케이션 서비스
- 설정 및 관리 용이성은 물론 높은 수준의 확장성, 유연성, 비용 효율성을 갖추고 있음
- 애플리케이션에서 메시지를 배포하면 즉시 구독자가 이를 수신할 수 있는 배포-구독(publish-subscribe) 매커니즘을 기반으로 동작
- 특정 주제 즉, topic의 메시지를 배포하는 즉시 이 토픽에 구독 신청을 한 서비스가 해당 메시지를 받아볼 수 있음
- 이벤트 기반 아키텍처를 사용하거나 성능, 신뢰성, 확장성을 높이기 위해 애플리케이션과 분리해서 사용할 수 있음
- Amazon SNS 주요 기능
    - 메시지는 다중 AZ 환경에 저장되므로 신뢰할 수 있음
    - HTTP/HTTPS, e-mail, SMS, Lambda, SQS 등 다양한 전송 프로토콜을 지원하므로 메시지 전송의 유연성이 높음
    - 메시지는 즉각 또는 지연시켜서 전달할 수 있음
        - 푸시 기반 전송을 통해 구독자에게 자동으로 메시지를 전송할 수 있음
    - SNS와 CloudWatch를 통합한 모니터링 기능을 통해 모든 토픽에 대한 성능 지표를 수집, 시각화, 분석할 수 있음
    - AWS 관리 콘솔, CLI, SDK, Amazon SNS Query API, Windows PowerShell을 이용해 접속 가능
    - 텍스트 데이터의 경우 최대 256KB, SMS의 경우 최대 140 bytes의 데이터를 담을 수 있음
        - 용량 제한을 초과하면 Amazon SNS가 메시지의 수를 늘려서 전송하되 단어 중간에서 자르지 않고 단어 전체를 기준으로 앞 단어와 뒤 단어 사이를 잘라서 전송
        - 단일 SMS 메시지의 총 용량은 1,600 bytes를 넘지 않아야 함
- Amazon SNS 이용
    - 토픽 생성
        - 토픽은 메시지를 전송하고 노티피케이션을 구독하기 위한 커뮤니케이션 채널
        - 배포자와 구독자의 연결점이기도 함
    - 토픽 구독
        - 토픽 메시지를 수신하려면 토픽의 앤드포인트에 구독 신청을 해야 함
        - 승인이 이뤄지면 해당 토픽으로 배포되는 모든 메시지를 엔드포인트를 통해 받아볼 수 있음
    - 토픽 배포
        - 배포자가 토픽에 메시지를 전송하면 Amazon SNS는 토픽에 구독 신청을 한 모든 엔드포인트에 메시지를 전송

## AWS Step Functions와 Amazon Simple Workflow(SWF)

- 시각화된 워크플로우를 통해 분산 애플리케이션 및 마이크로서비스 컴포넌트의 관리를 돕는 완전 관리형 서비스
- Amazon Simple Workflow(SWF)를 대체하기 위해 만들어짐
- AWS Step Functions
    - 애플리케이션을 상태 저장 및 관리를 위한 스테이트 머신(state machine)으로 정의
    - 앱의 동작을 한데 모아 일련의 스텝으로 관리할 수 있도록 도움
- AWS Step Functions 상태 타입
    - 임무(Task)
        - 업무 단위로 업무를 처리하기 위해 애플리케이션 컴포넌트 및 마이크로서비스를 호출함
        - 임무 상태는 두 가지
            - AWS Lambda 함수에 호출을 입력
            - 애플리케이션에 임무를 전달
    - 선택(Choice)
        - 스테이트 머신에 의사결정 로직을 적용할 수 있음
    - 병렬(Parallel)
        - 다수의 스테이트에 동일한 입력값을 전달할 수 있음
        - 결과를 하나의 출력값으로 결합할 수 있음
        - 데이터가 독립적으로 계속 변경되는 상황에서 유용하며 이미지 처리, 데이터 감소 등에 활용
    - 대기(Wait)
        - 해당 상태로 얼마나 대기할지 정할 수 있음
    - 실패(Fail)
        - 스텝의 실행을 중지시키고 실패로 표시
    - 성공(Success)
        - 실행을 성공적으로 중지시킴
    - 전달(Pass)
        - 입력값을 출력값에 전달
    - 맵(Map)
        - 맵 상태는 입력 배열의 각 요소에 대한 실행 단계 설정에 사용

## AWS Elastic Beanstalk

- 웹 애플리케이션을 배포할 수 있는 가장 간단하고 신속한 방법
- 사용자가 코드만 업로드하면 EC2, ECS, Auto Scaling, ELB 등 AWS 리소스에 대한 프로비전 업무를 대신 처리
- Elastic Beanstalk 세 가지 핵심 요소
    - 실행 환경(environment)
        - EC2, RDS, ELB, Auto Scaling 등을 가리킴
        - 하나의 실행 환경은 하나의 애플리케이션 버전만을 실행
        - 하나의 애플리케이션을 위해 다수의 실행 환경을 생성할 수 있음
        - 개발 환경, 테스트 환경, 상용 환경 등으로 나눠 애플리케이션 서비스를 제공할 수 있음
    - 애플리케이션 버전(application version)
        - S3에 저장된 애플리케이션 실행 코드
        - 다양한 버전을 포함할 수 있고 각 버전은 별도로 저장
    - 저장 환경 설정(saved configuration)
        - 환경 설정 및 리소스 동작을 정의
        - 새로운 실행 환경을 신속하게 론칭하고 이전의 설정 환경으로 돌아갈 수 있도록 도움
        - 하나의 애플리케이션은 다수의 저장 환경 설정을 지닐 수 있음
- AWS Elastic Beanstalk는 서로 다른 유형의 웹 애플리케이션을 지원하기 위해 웹 서버와 워커라는 두 가지 실행 환경 티어를 제공
    - 웹 서버는 HTTP 요청 수신 및 처리를 담당하는 표준 애플리케이션으로 주로 80 포트를 사용
    - 워커는 SQS 큐 메시지를 수신하기 위해 백그라운드에서 실행되는 특수한 애플리케이션
        - HTTP를 이용해서 사용자의 애플리케이션에 메시지를 전달함
- 애플리케이션은 단일 인스턴스 또는 데이터베이스가 포함된 다수의 인스턴스에 배포될 수 있음
    - 애플리케이션이 다수의 인스턴스에 배포된 경우
        - 로드 밸런서, Auto Scaling 그룹, 시큐리티 그룹, 데이터베이스 등 인프라 리소스를 프로비전
        - Route 53 환경 설정을 통해 도메인 네임을 부여
    - 단일 인스턴스는 주로 개발 및 테스트 용도로 사용
    - 다수의 인스턴스는 주로 사용 워크로드에 사용

## AWS OpsWorks

- 모든 유형과 규모의 애플리케이션 배포 및 운영을 돕는 환경 설정 관리 서비스
- 애플리케이션의 신속한 환경 설정, 배포, 업데이트를 지원
- 자동화된 스케일링 및 헬스 모니터링 도구를 제공
- OpsWorks는 세 가지 도구를 제공
    - Chef Automate
        - 완전 관리형 Chef 서버
        - 지속적 배포와 준수 규정 및 보안 사항에 대한 테스트를 위한 종합적인 자동화 도구
        - 노드와 노드별 상태 정보를 시각화한 사용자 인터페이스를 제공
    - Puppet Enterprise
        - 관리형 Puppet Enterprise 서버
        - 오케스트레이션, 자동화 프로비저닝, 추적 데이터 시각화 등 종합적인 워크플로우 자동화 도구
    - OpsWorks Stacks
        - AWS와 온프레미스 환경의 애플리케이션 및 서버 관리를 도움
        - 전체 애플리케이션을 다수의 레이어를 지닌 스택 형식으로 모델링할 수 있음

## Amazon Cognito

- 다수의 모바일 디바이스에서 사용자를 좀 더 편리하게 관리할 수 있도록 도와주는 사용자 신원 증명 및 데이터 동기화 서비스
- 퍼블릭 로그인 제공자인 Google, Facebook, Amazon, 기업용 로그인 서비스로서 SAML 기법을 사용하는 Microsoft Active Directory 등이 만든 신원 증명 기능을 이용해 사용자의 신원 정보를 효과적으로 관리할 수 있음
- Amazon Cognito는 비인증 신원 증명 방식을 지원
- Amazon Cognito User Pools는 표준 기반 신원 증명 제공자로서 OAuth 2.0, SAML 2.0, OpenID Connect 등 IAM 표준을 지원
- 모든 종류의 유저 데이터 및 키 밸류 페어를 동기화하는 데 사용할 수 있음
- 모바일 앱에서 AWS 리소스에 대한 접근 관리를 도움
    - 리소스 사용 권한을 롤 형태로 정의하고, 유저에게 롤을 할당해 유저별로 접근이 가능한 리소스에만 선별적으로 접근할 수 있음
- Amazon Cognito는 사용자가 자신의 디바이스에 상관 없이 일관된 사용자 경험을 누릴 수 있다는 장점과 개발자는 이를 위해 복잡한 백엔드 코드 작성 및 동기화에 대한 걱정을 할 필요가 없다는 장점을 제공

## Amazon Elastic MapReduce

- EC2 및 S3와 같은 탄력적인 인프라를 활용해 다수의 EC2 인스턴스를 분산 컴퓨팅 환경으로 구성한 관리형 Hadoop 프레임워크 서비스를 제공
- Amazon EMR 클러스터의 노드
    - 마스터 노드
        - 코어 노드와 태스크 노드의 잡 배분을 조율
    - 코어 노드
        - 마스터 노드가 할당한 태스크를 실행하는 역할을 함
        - 클러스터 내 HDPS에 데이터를 저장
    - 태스크 노드
        - 태스크를 실행만 하고 저장은 하지 않음
        - 필요에 따라 사용 가능
        - 클러스터를 위한 순수한 연산 기능만 제공
- 스팟 인스턴스는 Amazon EMR을 사용하기 위한 매우 좋은 방법
- 순수하게 연산만 필요한 경우 태스크 노드를 적극 활용 할 수 있음
- Amazon EMR을 이용해 MapReduce를 실행하거나 Hive, Pig, HBase, Impala, Cascading, Spark 등 빅데이터 분석을 위한 강력한 애플리케이션 및 프레임워크를 사용할 수 있음

## AWS CloudFormation

- 작성한 인프라 아키텍처 모델에 따라 AWS 리소스 스택의 프로비전 및 관리를 도움
- CloudFormation 사용 방법
    - 템플릿을 생성
        - 템플릿은 AWS 리소스의 환경 설정을 위한 설계도
    - 템플릿을 CloudFormation에 업로드
        - 필요에 따라 인스턴스의 수, 인스턴스의 타입 등 파라미터를 선택
    - CloudFormation이 AWS 리소스 스택을 프로비전 및 환경 설정하게 됨
    - AWS 관리 콘솔, CLI 또는 SDK 등을 이용해 템플릿을 수정해 업로드함으로써 CloudFormation 스택을 갱신할 수 있음
- CloudFormation에 대한 별도 사용료는 없으며 CloudFormation에서 생성하고 애플리케이션에서 사용된 AWS 리소스 이용료만 부담하면 됨
- AWS CloudFormation을 이용하려면 템플릿과 스택이 필요함
    - 템플릿을 이용해서 AWS 리소스와 프로퍼티를 정의할 수 있음
    - 스택 생성 시 CloudFormation은 템플릿 별로 리소스를 프로비전함
    - 사용자는 스택을 단일 개체 또는 유닛처럼 관리할 수 있음
    - 스택 내의 실행 중인 리소스를 변경하려면 스택 전체를 업데이트해야 함

## Amazon CloudWatch

- AWS 클라우드에 배포된 모든 리소스를 모니터링하기 위한 서비스
- 헬스 체크, 활성화 수준 검토, 성능 확인 등 주요 지표를 모니터링
- AWS 클라우드 리소스는 물론, 클라우드 기반 애플리케이션을 모니터링해 주요 성능 지표를 시각화 및 분석

### 성능 지표 수집 및 추적

- Amazon CloudWatch는 모든 서비스에 대한 성능 지표를 제공
- 모든 서비스와 관련된 100여개 이상의 성능 지표 유형을 사용할 수 있음
- 기본 설정 성능 지표 외에도 사용자가 정의한 커스텀 성능 지표를 추가 가능
- 지표 수집 간격
    - 1분 데이터 포인트의 경우 15일간 보존
    - 5분 데이터 포인트의 경우 63일간 보존
    - 1시간 데이터 포인트의 경우 15개월 또는 455일간 보존

### Amazon CloudWatch Events를 이용한 실시간 모니터링

- Amazon CloudWatch Events는 AWS 리소스에 생긴 사소한 변화도 모두 감지할 수 있음
- 변화를 감지하면 근실시간으로 지정된 타깃에 알림을 전송
    - 타깃은 Lambda 함수, SNS 큐, Amazon SNS 토픽, Kinesis Stream 또는 기타 이벤트와 연결된 타겟
    - 규칙이나 액션을 미리 정의 가능

### 모니터링 및 Logs 저장

- CloudWatch Logs는 기존 시스템, 애플리케이션, 커스텀 로그 파일을 이용해 사용자의 시스템, 애플리케이션을 모니터링하거나 문제점을 해소할 수 있도록 도움

### 알람 설정

- CloudWatch 알람을 생성해 알람 상태 변경 시 Amazon SNS 메시지를 전송하도록 할 수 있음
- 일정 시간동안 단일 지표를 관찰
    - 해당 지표가 기준치를 벗어나면 하나 또는 그 이상의 액션을 취함
    - 액션은 Amazon SNS 토픽에 전송한 노티피케이션 또는 Auto Scaling 정책 등 가능
    - CloudWatch 알람은 특정 상태가 유지되는 것을 가정
        - 액션이 호출되려면 상태가 변경되어야 하며 일정 기간동안 이 상태가 유지될 수 있어야 함
- 알람 설정 상태
    - OK: 성능 지표가 미리 정의된 기준치 내에 있는 상태
    - ALARM: 성능 지표가 미리 정의된 기준치를 벗어난 상태를 의미
    - INSUFFICIENT_DATA: 알람이 막 시작됐지만 성능 지표가 부족하거나 알람 상태를 유지하기에는 데이터가 부족함을 의미

### 그래프와 통계정보 시각화

- Amazon CloudWatch 대시보드를 통해 리소스가 제공하는 다양한 그래프와 통계정보를 확인할 수 있음
- 커스텀 대시보드를 생성해 사용 중인 다양한 리소스를 통합해 파악할 수 있음
- 대시보드는 선택한 성능 지표에 대한 싱글 뷰 모드로 제공됨
- 다수의 리전에 분포한 리소스, 애플리케이션의 헬스 수준을 판단할 수 있음

## AWS CloudTrail

- 콘솔, CLI 등 도구를 통해 전달된 모든 API 호출 로그를 관리하는 서비스
- 해당 API에 대해 누가, 언제, 어디서, 어떤 작업을 했는지 로그 데이터로 저장
- 관리자는 CloudTrail을 이용
    - AWS 리소스 변경 추적
    - 규정 준수 여부 파악
    - 운영상의 문제 발견
- AWS CloudTrail의 이벤트 히스토리는 해당 리전에서 90일 간 보존
- 하나의 리전당 다섯 개의 트레일 생성 가능
- CloudTrail 로그 데이터는 S3, CloudWatch Logs, Amazon CloudWatch Events에 전송 가능

## AWS Config

- 사용자 계정에 포함된 AWS 리소스와 현재의 환경 설정에 대한 세부적인 목록을 제공하는 완전관리형 서비스
- 리소스에 생기는 환경 설정 상의 변화를 지속적으로 기록
- 환경 설정 규칙은 리소스에 대한 이상적인 환경 설정 내역을 담은 것
    - 리소스에 이러한 규칙과 다른 상황이 발생할 경우 AWS Config에 기록
- AWS Config 작업
    - 지속적 모니터링
        - AWS 리소스에 대한 지속적인 모니터링 지원
    - 지속적 평가
        - AWS 리소스에 대한 프로비전 및 환경 설정 규칙 정의 가능
        - 변경된 AWS 리소스 환경 설정 내역이 기업의 정책 및 규정에 부합하는지를 감사 및 평가할 수 있음
    - 변화 관리
        - 변경 내역, 발생 시간, 다른 AWS 리소스에 미치는 영향 등을 추적 가능
        - 변경 사항 반영 전에 리소스 간의 관계, 리소스의 독립성 등을 추적 가능
    - 운영상의 문제 해결
        - AWS Config는 AWS CloudTrail과 통합할 수 있음
        - 환경 설정 변경과 특정 이벤트의 상관 관계를 파악할 수 있음
    - 규정 준수 모니터링

## Amazon VPC Flow Logs

- VPC 네트워크 인터페이스의 IP 트래픽 정보를 수집한 뒤 Amazon Cloud Watch Logs를 이용해 로그 데이터를 저장
- Elasticsearch 또는 Kibana 등의 서비스와 통합해 로그 데이터를 시각화하거나 인스턴스에 특정 트래픽이 도달하지 못하는 문제를 해결할 수 있음
- Flow Logs는 시큐리티 그룹과 네트워크 ACL 규칙에 따라 승인된 트래픽은 물론 거부한 트래픽 정보도 모두 수집
    - 소스 및 대상 IP 주소, 포트, IANA 프로토콜 번호, 패킷과 바이트 수, 시간 간격 등의 정보
    - ACCEPT 또는 REJECT 등 트래픽에 따른 액션의 종류도 포함
- 활성화 가능 네트워크 레벨
    - VPC
    - Subnet
    - Network Interface

## AWS Trusted Advisor

- 주요 기능
    - 비용 최적화
    - 보안성
    - 장애 대응성
    - 성능
    - 서비스 용량 제한 관리
        - 서비스 용량 제한선의 80% 초과 여부를 확인
        - 초과 여부는 스냅샷을 기준으로 판단, 변경 사안 반영에 최대 24시간 소요 가능
- 대시보드 정보 색상
    - 빨간색: 대응 동작이 필요
    - 노란색: 상태 확인이 필요
    - 녹색: 문제가 없음

## AWS Organizations

- 계정 관리 업무의 일원화, 간소화하며, 다수의 AWS 계정에 정책 기반 관리 기법을 적용할 수 있음
- 계정 그룹 생성 후 그룹에 정책을 적용해 API 레벨에서 AWS 서비스에 대한 접속 및 이용을 중앙화된 계정 시스템으로 관리

## CloudTrail vs Config vs Trusted Advisor

### CloudTrail

- 콘솔 접속, CLI 명령 등 모든 API 호출의 로그를 기록 및 관리하는 서비스
- 로그를 통해 누가 언제 어디서 무슨 작업을 했는지 파악할 수 있음
- API 호출에 대해 어떤 리소스가 어떻게 반응했는지, API 호출이 어디에서 생성돼 어디로 이동했는지도 알 수 있음
- 모든 AWS 환경에서의 일어난 접속, 변경, 기타 동작을 모두 파악할 수 잇음
- 로그는 S3 버킷에 저장

### Config

- AWS 리소스에 대한 세부적인 인벤토리 및 환경 설정 정보를 제공하는 완전 관리형 서비스
- 리소스의 환경 설정 (EC2 인스턴스 론칭, 시큐리티 그룹의 ingress/egress 규칙, VPC의 네트워크 규칙 등) 에 대한 변경 사항을 지속적으로 기록

### Trusted Advisor

- 비용 최적화, 보안, 장애 대응성, 성능, 서비스 용량 제한 등 다섯 가지 모범 지표를 제공

### 차이점

- 세 가지 모두 다른 방식으로 작동하는 모니터링 도구임
- CloudTrail은 이상 징후를 예측할 만큼 지능적이진 않음
    - API 호출로 인해 생성된 로그는 기록에 불과
    - 관리자가 따로 구성을 해 줄 필요가 없음
- Trusted Advisor는 비용 절감 및 성능 향상에 대한 추천을 할 수 있음
    - 관리자가 Trusted Advisor에 모니터링 규칙을 연결할 순 없음
- Config는 CloudTrail, Trusted Advisor와 달리 모니터링 규칙을 연결해야 함
    - 관리자가 설정한 구성에 맞춰 실시간으로 리소스 구성의 변화를 모니터링 함
- 예로 CloudTrail은 EC2 인스턴스 시작을 기록, Trusted Advisor는 사용자에게 Public SG의 구성을 변경하도록 제안, Config는 EC2 인스턴스에서 볼륨이 제거되면 실시간으로 보고서를 구성하여 보고
- Config는 무엇이 변경되었는지, CloudTrail은 누가, 언제, 어디서 변경했는지가 중점
    - Config는 AWS 리소스 및 보고서 구성에 중점, 리소스가 어떻게 변경되었는지에 대한 스냅샷 제공
    - CloudTrail은 이런 변화를 만들어 내는 API 호출에 초점, 시스템에서 수행되는 사용자, 애플리케이션 및 활동에 초점
