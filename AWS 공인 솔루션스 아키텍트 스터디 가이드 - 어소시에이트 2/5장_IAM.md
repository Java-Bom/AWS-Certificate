IAM의 신분 인증과 주요기능 

- 유저 및 접근 권한 관리
  - 유저의 접근, 수행작업 통제
- 그룹화된 유저 및 접근 권한 관리
  - SSO, SAML, AD, ldP 지원

권한부여

- 최소한의 권한 부여 및 책임 분리 컨셉
  - IAM 정책은 JSON으로 작성된 규칙
  - 어떠한 리소스에 어떠한 작업이 가능한지 정의
  - 해당요소에 필요한 만큼 정책추가 가능
  - 다수의 엔티티(=IAM 유저)에 한번에 정책을 적용 가능
  - 기본 설정은 모든 리소스에 접근 거부
    - 명시적으로 허용표시를 해야한다.
    - 명시적으로 거부하는것도 가능하다.

감사

- AWS CloudTrail
  - 계정에서 일어나는 일을 기록, 로그파일을 S3에 저장한다.
    - 작업 요청 유저
    - 작업 요청 시간
    - 요청 작업 내용
    - 요청 작업에 제공된 리소스
    - 요청 발송 장소, 도달 장소

보안 자격 정보 유형

- IAM 유저네임과 패스워드: AWS 콘솔 로그인

- Email, 패스워드: 루트 계정 연동
- 엑세스 키: CLI, API, SDK 
  - 발급시 엑세스 키 ID, 시크릿 엑세스 키를 반환한다.
    - 생성당시에만 유효하다
    - 분실시 기존 키 삭제후 새로 발급해야한다.
- 키 페어: EC2 서버 로그인
- 멀티팩터인증(MFA): 루트 계정 로그인시 추가 보안

임시 보안 자격 정보

- 단시간 사용 목적 (단기적 유효성)
  - 유효시간이 만료되면 사용 불가 (자동 만료성)
- 다른 유저에게 AWS 리소스에 대한 접근 권한을 잠깐 부여하는 용도
  - AWS 토큰서비스를 이용 (STS)
    - 따로 아이디를 부여하지 않아 보안적으로 우수하다.

유저 (IAM 유저)

- 유일무이한 개체(=엔티티)
- 유저네임과 보안자격정보를 가진다.
- 처음 생성시 아무런 리소스에 접근이 불가능하다.
- AWS 계정생성시 루트계정을 보유한다.
  - 루트계정은 모든 리소스에 접근이 가능하다.
  - 루트계정으로 로그인하는것은 지양하라.
  - 어드민 계정을 만들어 어드민계정을 활용하라.
  - 멀티팩터인증을 적용하라

그룹

- 그룹은 다수의 역할과 권한으로 구성되고 IAM을 이용해 승인한다.
- 그룹에 추가된 유저는 그룹에 정의된 역할과 권한을 상속
- 그룹에 다수의 유저 추가 가능
- 하나의 유저가 다수의 그룹에 포함 가능
- 하나의 그룹을 다른 그룹에 포함 불가능, 그룹에는 오직 유저만 추가 가능
- 모든 유저를 추가한 그룹은 별도로 생성해야 한다.

롤

- 유저 또는 서비스가 필요로 하는 리소스에 일련의 접근 승인 규칙을 추가한다.
  - 한 유저, 서비스에만 국한되지 않는다.
- AWS 사용자 타입
  - 영구적인 신분이 아닌 IAM 그룹
    - 영구적인 신분이 없으므로 롤을 생성해 승인권을 관리한다.
  - 영구적인 신분의 IAM 유저
    - 롤 추가는 가능하다
- 보안 승인 정보가 없다.
  - 할당 시 자동으로 생성되어 적용된다.
- 활용방식
  - 리소스에 접근하지 않는 유저, 애플리케이션, 서비스의 접근대행
  - 앱 내부에 AWS키를 임베딩 하기 싫을때
  - AWS 외부에서 이미 인증된 사용자에게 접근권한을 부여할 때
  - 제 3자에게 접근권한을 부여할 때
  - 특정 애플리케이션이 이미 다른 AWS 서비스를 사용할 수 있는 경우
  - 특정 임무만을 수행하기 위해 임시 보안 승인이 필요한 경우
- 정책
  - 신뢰정책
    - 누가 롤을 맡을 것인가
  - 접근 승인-권한 정책
    - 어떤 리소스에 접근 또는 액션을 할것인가

IAM 권한의 계층

- 권한이 가장 높은 유저를 맨 앞에
- 권한이 가장 낮은 유저를 맨 뒤에

베스트 프랙티스

- IAM 유저 활용
  - 루트 계정 x
- 강력한 패스워드 정책
  - 90일 폐기
- 정기적으로 보안 자격 정보 갱신
- MFA
- 그룹으로 승인 관리
- 최소한의 권한 부여
- IAM 롤 활용
- EC2 인스턴스를 위한 IAM 롤 활용
- 보안 강화를 위한 IAM 정책 조건 수립
- AWS CloudTrail

AWS 보안 규정 프로그램

- 클라우드 내에서 보안 유지 및 데이터 보호가 어떻게 이뤄졌는지
- 보안솔루션 배포가 가능하다
  - 보고서의 다운로드에 비공개 동의가 필요(NDA)
    - 필요시 AWS 영업책임자와 협의 필요

AWS 공유 책임 모델

- AWS 측 책임
  - 데이터 센터에 대한 물리적 보안
  - EC2 보안
    - 루트 유저를 위한 운영체제 호스팅에 대한 보안 책임
    - 고객의 인스턴스 또는 게스트 OS에 대한 접근권한은 없으므로 로그 데이터 기록을 하지 않는다.
  - 네트워크 보안
  - 환경설정 관리
  - 고가용성 데이터 센터
  - 디스크 관리
    - 다른 사용자의 디스크 공간, 데이터 영역을 볼 수 없도록 관리
  - 스토리지 디바이스 폐기
- 고객 측 책임
  - 운영체제
    - 게스트 OS의 관리에 대한 책임
  - 애플리케이션
  - 방화벽
    - 시큐리티 그룹으로 OS레벨의 방화벽
    - NACL로 네트워크 레벨의 보안
  - 네트워크 환경설정
    - VPC 보안 환경 설정
  - 서비스 환경설정
  - 자격인증 및 계정관리

- IaaS
  - AWS
    - 근원 서비스
    - AWS 글로벌 인프라
    - AWS API 엔드포인트
    - 운영체제
    - 플랫폼/애플리케이션
  - 고객
    - 고객 데이터
    - VPC, 방화벽
    - 고객 IAM
    - AWS IAM
    - 고가용성
    - 데이터 보호
    - 확장성
- PaaS
  - AWS
    - Foundational Services 근원 서비스
    - AWS 글로벌 인프라
    - AWS API 엔드포인트
    - 운영체제
    - 플랫폼/애플리케이션
    - 데이터 보호
    - 고 가용성/확장성
  - 고객
    - 고객 데이터
    - 데이터 보호
    - AWS IAM

AWS 보안 제품 및 서비스

- Resource Access Manager
  - AWS 리소스를 다른계정, 오가니제이션을 통해 연결하여 사용할 수 있다.
  - 보안 통제 가능
  - 리소스에 대한 감사 업무 감사
- AWS Secerets Manager
  - 기업 비밀을 관리
    - 사용자에 의한 기업 비밀 관리, 인출
    - 데이터 베이스 접근 권한
    - API 키 순회 변경
    - 기업 비밀의 생애주기 관리
  - Private Links 를 이용해 VPC 엔드포인트를 지원
  - CloudFormation과 통합
  - PCI, HIPAA, ISO 규정 준수
  - CloudTrail, CloudWatch로 보안가시성 제공
  - RDS, Lambda와 통합 사용가능
- Amazon GuardDuty
  - 지능형 보안 위협 감지 서비스
  - 머신러닝으로 대처
  - 유형
    - 공격자의 정찰행위
      - 실패한 로그인, IP 포트 개방, VPC 포트 스캐닝, 특이한 API 활동, 공격자에 의한 정찰 행위
    - 인스턴스에 대한 위협
      - DDoS, 코인채굴, 접속거부행위, 비정상적 트래픽
    - 계정에 대한 위협
      - 프록시 서버에 의한 미확인 지역에서의 로그인 요청, API 호출
- Amazon Inspector
  - EC2 인스턴스의 잠재적인 보안, 환경 설정 문제 진단
  - CI/CD 주기 동안 EC2 인스턴스 환경에서 애플리케이션의 보안 위협 여부를 확인
- Amazon Macie
  - S3에 저장된 데이터 보호
  - 머신러닝으로 민감한 데이터를 자동으로 발견, 분류, 보호
  - 경고 메세지 발송
- AWS Certificate Manager
  - SSL 인증서 관리
  - TLS 인증서 프로비전, 관리, 배포
  - ACM을 이용하여 인증서 획득, 갱신, 임포트
    - ELB, CloudFront에 사용
  - SSL/TLS에 별도 비용지불은 없다
- AWS Web Application Firewall
  - 악성 트래픽 감지용 방화벽
  - SQL 인젝션, 스크립팅 방어
  - 오가니제이션과 통합사용 가능
- AWS Shield
  - DDoS 대응용
    - Standard
      - 무료
      - DDoS 공격 유형 방어
    - Advanced
      - ELB, CloudFron, Route53 에 사용
- AWS CloudHSM
  - 변조 저항성 하드웨어 보안 모듈
  - 계약 및 법규 준수용
  - 데이터 베이스 암호화, 문서결제, 디지털 권리 관리
- AWS KMS
  - 암호화 작업용 키 생성 및 제어용 관리 서비스
  - 단일 제어 지점에서 다수의 통합 서비스 및 애플리케이션을 이용하기 위한 키 관리
  - 하드웨어 보안 모듈을 사용
  - 디지털 서명 기법 용도
  - 비대칭 키로 데이터 검증

